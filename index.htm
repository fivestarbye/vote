<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æŠ•ç¥¨å‹‡è€…å¤§å†’éšª</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #e0f2f1, #ffffff);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      color: #2e3440;
      animation: fadeIn 1.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .game-box {
      width: 100%;
      max-width: 480px;
      margin: 20px 0;
      background-color: #ffffffee;
      padding: 16px;
      border-radius: 16px;
      box-shadow: 0 6px 14px rgba(0,0,0,0.15);
      transition: transform 0.3s;
    }
    .game-box:hover {
      transform: scale(1.01);
    }
    .btn-grid {
      display: flex;
      justify-content: space-around;
      margin-top: 16px;
      gap: 10px;
    }
    .btn {
      flex: 1;
      padding: 16px;
      font-size: 1.2em;
      border: none;
      border-radius: 12px;
      background: linear-gradient(to right, #26c6da, #00acc1);
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn:active {
      transform: scale(0.96);
      background: #00838f;
    }
    .leaderboard {
      margin-top: 30px;
      max-width: 480px;
      text-align: center;
      background: #ffffffdd;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .rules {
      max-width: 480px;
      background: #ffffffcc;
      padding: 16px;
      border-radius: 10px;
      margin-top: 10px;
      font-size: 0.95em;
    }
    #eventText {
      font-weight: bold;
      margin-top: 10px;
      min-height: 1.5em;
    }
    #restartBtn {
      margin-top: 10px;
      display: none;
      text-align: center;
    }
    .quiz-box {
      margin-top: 16px;
      padding: 10px;
      background: #e3f2fd;
      border-radius: 10px;
    }
    .quiz-option {
      margin: 6px 0;
      display: block;
      padding: 10px;
      border-radius: 6px;
      background: #bbdefb;
      cursor: pointer;
    }
    .quiz-option:hover {
      background: #90caf9;
    }
  @keyframes flashGreen {
  0% { background-color: #c8e6c9; }
  100% { background-color: transparent; }
}
@keyframes flashRed {
  0% { background-color: #ffcdd2; }
  100% { background-color: transparent; }
}
@keyframes flashGreen {
  0% { background-color: #c8e6c9; }
  100% { background-color: transparent; }
}
@keyframes flashRed {
  0% { background-color: #ffcdd2; }
  100% { background-color: transparent; }
}
@keyframes moveChar {
  0% { transform: translateY(0) scale(1); }
  25% { transform: translateY(-20px) scale(1.2); }
  50% { transform: translateY(5px) scale(1); }
  75% { transform: translateY(-10px) scale(1.1); }
  100% { transform: translateY(0) scale(1); }
}
  25% { transform: scale(1.1) translateY(-10px); opacity: 0.8; }
  50% { transform: scale(1.05) translateY(4px); opacity: 1; }
  75% { transform: scale(1.1) translateY(-6px); opacity: 0.9; }
  100% { transform: scale(1) translateY(0); opacity: 1; }
}
  50% { transform: scale(1.05) translateY(-4px); }
  100% { transform: scale(1) translateY(0); }
}
@keyframes specialEvent {
  0% { background-color: #fff3cd; transform: scale(1); }
  50% { background-color: #ffe082; transform: scale(1.2); }
  100% { background-color: transparent; transform: scale(1); }
}
  100% { background-color: transparent; }
}
.character {
  font-size: 2em;
  transition: transform 0.3s ease;
  animation: moveChar 0.6s;
  margin-bottom: 8px;
  display: inline-block;
}
.special {
  animation: specialEvent 0.6s ease;
}
</style>
</head>
<body>
  <h1>æŠ•ç¥¨å‹‡è€…å¤§å†’éšª</h1>
  <div class="rules">
    <h3>ğŸ¯ éŠæˆ²è¦å‰‡</h3>
<ul>
  <li>æ¯æ¬¡å¯é¸æ“‡ å·¦èµ°ã€å‰é€² æˆ– å³èµ°</li>
  <li>æ¯å€‹åœ°é»å¯èƒ½å‡ºç¾äº‹ä»¶ï¼ˆå¥½äº‹æˆ–å£äº‹ï¼‰æˆ–ç½·å…å°çŸ¥è­˜å•ç­”</li>
  <li>éŠæˆ²è‡³å°‘é€²è¡Œ 5 æ­¥ï¼Œä¹‹å¾Œå¯èƒ½å‡ºç¾ã€Œç½·å…æŠ•ç¥¨æ‰€ã€çµå±€</li>
  <li>çµå±€å°‡æ ¹æ“šåˆ†æ•¸çµ¦äºˆä¸åŒè©•èªï¼Œä¸¦å¯ä¸Šå‚³æ’è¡Œæ¦œ</li>
</ul>
  </div>
  <div class="game-box">
  <div class="character" id="hero">ğŸ§</div>
    <p id="location">ä½ ç›®å‰åœ¨ï¼š</p>
    <p id="score">åˆ†æ•¸ï¼š0</p>
    <p id="eventText"></p>
    <div class="btn-grid">
      <button class="btn" onclick="move('left')">â¬… å·¦èµ°</button>
      <button class="btn" onclick="move('forward')">â¬† å‰é€²</button>
      <button class="btn" onclick="move('right')">â¡ å³èµ°</button>
    </div>
    <div class="quiz-box" id="quizBox" style="display:none">
      <p id="quizQuestion"></p>
      <div id="quizOptions"></div>
    </div>
    <div id="winMessage" style="margin-top:10px;font-weight:bold;"></div>
    <div id="restartBtn">
      <button class="btn" onclick="restartGame()">ğŸ”„ é‡æ–°é–‹å§‹</button>
    </div>
  </div>
  <div class="leaderboard">
    <h3>ğŸ† æ’è¡Œæ¦œ</h3>
    <ol id="scoreList"></ol>
    <div id="submitSection" style="display: none">
      <input type="text" id="playerName" placeholder="ä½ çš„åå­—" />
      <button onclick="submitScore()">æäº¤åˆ†æ•¸</button>
    </div>
  </div>
  <script>
    let row = 0, col = 1;
    let score = 0;
    let steps = 0;
    const events = [
      { name: "é‡åˆ°å†·æ¼ è·¯äºº", effect: -2 },
      { name: "å‡æ¶ˆæ¯å¹²æ“¾", effect: -1 },
      { name: "å¥½æœ‹å‹åŒè¡Œ", effect: +2 },
      { name: "æ’¿åˆ°èº«åˆ†è­‰", effect: +3 },
      { name: "ç©ºåœ°ä¼‘æ¯", effect: 0 },
      { name: "çŸ¥è­˜æŒ‘æˆ°", effect: "quiz" }
    ];

    const quizzes = [
  {
    q: "ç™¼èµ·ç½·å…ç¬¬ä¸€éšæ®µé€£ç½²éœ€å¹¾äººï¼Ÿ",
    options: ["é¸èˆ‰äººç¸½æ•¸1%ä»¥ä¸Š", "é¸èˆ‰äººç¸½æ•¸5%ä»¥ä¸Š", "é¸èˆ‰äººç¸½æ•¸10%ä»¥ä¸Š"],
    answer: 0
  },
  {
    q: "ç½·å…æ¡ˆè¦æˆç«‹ï¼ŒæŠ•ç¥¨ç‡é ˆé”å¤šå°‘ï¼Ÿ",
    options: ["10%", "25%", "50%"],
    answer: 1
  },
  {
    q: "ç½·å…é–€æª»ä¸­ï¼Œè´Šæˆç¥¨é ˆï¼Ÿ",
    options: ["è¶…éåå°ç¥¨ä¸”é”æŠ•ç¥¨æ¬Šäººç¸½æ•¸å››åˆ†ä¹‹ä¸€", "éåŠå³å¯", "èˆ‡ç¸½æŠ•ç¥¨æ•¸ç„¡é—œ"],
    answer: 0
  },
  {
    q: "å“ªä¸€é …å±¬æ–¼ç½·å…ç†ç”±ï¼Ÿ",
    options: ["è¨€è«–ä¸åˆå·±æ„", "é‡å¤§å¤±è·æˆ–é•æ³•å¤±ä¿¡", "å¹´ç´€å¤ªå¤§"],
    answer: 1
  },
  {
    q: "ç½·å…æŠ•ç¥¨çµæœèª°è² è²¬å…¬å‘Šï¼Ÿ",
    options: ["ä¸­é¸æœƒ", "åœ°æ–¹é¸å§”æœƒ", "å…§æ”¿éƒ¨"],
    answer: 0
  },
  {
    q: "ç½·å…æˆåŠŸå¾Œï¼Œè©²è·ä½å¦‚ä½•è™•ç†ï¼Ÿ",
    options: ["è‡ªå‹•è£œé¸", "ç”±æ”¿åºœæŒ‡æ´¾", "ç•™ä¸‹ç©ºç¼º"],
    answer: 0
  }
];

    function updateUI() {
  const landmarks = [
    ["åŸºéš†æ¸¯", "ç‘èŠ³è€è¡—", "å¹³æºªå¤©ç‡ˆ"],
    ["å°åŒ—101", "ä¸­æ­£ç´€å¿µå ‚", "å£«æ—å¤œå¸‚"],
    ["æ–°ç«¹åŸéšå»Ÿ", "å°ä¸­å…¬åœ’", "é¹¿æ¸¯è€è¡—"],
    ["å˜‰ç¾©æªœæ„æ£®æ´»æ‘", "å°å—å®‰å¹³å¤å ¡", "é«˜é›„æ„›æ²³"],
    ["å¢¾ä¸å¤§è¡—", "å±æ±è»ŠåŸ", "å°æ±æ± ä¸Š"],
    ["èŠ±è“®ä¸ƒæ˜Ÿæ½­", "å®œè˜­ç¾…æ±å¤œå¸‚", "è˜­å¶¼å¤§å¤©æ± "]
  ];
  let name = "æœªçŸ¥åœ°é»";
  if (row >= 0 && row < landmarks.length && col >= 0 && col < landmarks[row].length) {
    name = landmarks[row][col];
  }
  document.getElementById("location").textContent = `ä½ ç›®å‰åœ¨ï¼š${name}`;
      document.getElementById("score").textContent = `åˆ†æ•¸ï¼š${score}`;
    }

    function triggerRandomEvent() {
  steps++;
  document.getElementById("quizBox").style.display = "none";
  if (steps >= 5 && Math.random() < 0.25) {
    gameEnded = true;
    document.querySelectorAll('.btn').forEach(btn => btn.disabled = true);
    updateUI();
  document.getElementById("hero").classList.remove("special");
    document.getElementById("eventText").textContent = "ä½ æ‰¾åˆ°äº†æŠ•ç¥¨æ‰€ï¼";
    document.getElementById("winMessage").textContent =
      score >= 6 ? 'ğŸ‰ é«˜åˆ†çµå±€ï¼šä½ æˆåŠŸæŠ•ç¥¨ï¼' : 'ğŸ˜ æ™®é€šçµå±€ï¼šå‹‰å¼·å®Œæˆä»»å‹™ã€‚';
    document.getElementById("submitSection").style.display = "block";
    document.getElementById("restartBtn").style.display = "block";
    
    
    return;
  }
  const e = events[Math.floor(Math.random() * events.length)];
  if (e.effect === "quiz") {
    if (!window.usedQuizIndices) window.usedQuizIndices = [];
    let availableIndices = quizzes.map((_, idx) => idx).filter(idx => !window.usedQuizIndices.includes(idx));
    if (availableIndices.length === 0) {
      window.usedQuizIndices = [];
      availableIndices = quizzes.map((_, idx) => idx);
    }
    const nextIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
    window.usedQuizIndices.push(nextIndex);
    const quiz = quizzes[nextIndex];
    document.getElementById("eventText").textContent = "ğŸ§  çŸ¥è­˜å•ç­”æŒ‘æˆ°ï¼";
    showQuiz(quiz);
    return;
  }
  score += e.effect;
      document.getElementById("eventText").textContent = `${e.name}ï¼ˆåˆ†æ•¸ ${e.effect > 0 ? '+' + e.effect : e.effect}ï¼‰`;
document.getElementById("hero").classList.add("special");
      updateUI();
    }

    function showQuiz(quiz) {
      document.getElementById("quizBox").style.display = "block";
      document.getElementById("quizQuestion").textContent = quiz.q;
      const optionsBox = document.getElementById("quizOptions");
      optionsBox.innerHTML = "";
      quiz.options.forEach((opt, i) => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.className = "quiz-option";
        btn.onclick = () => {
          if (i === quiz.answer) {
            score += 3;
            document.getElementById("eventText").textContent = "âœ… ç­”å°äº†ï¼åŠ  3 åˆ†ï¼";
document.getElementById("eventText").style.animation = "flashGreen 0.6s";
          } else {
            score -= 1;
            document.getElementById("eventText").textContent = "âŒ ç­”éŒ¯äº†ï¼æ‰£ 1 åˆ†ï¼";
document.getElementById("eventText").style.animation = "flashRed 0.6s";
          }
          updateUI();
          document.getElementById("quizBox").style.display = "none";
        };
        optionsBox.appendChild(btn);
      });
    }

    function move(direction) {
  if (document.getElementById("quizBox").style.display === "block") return;
  if (gameEnded) return;
  if (direction === "left") col--;
  else if (direction === "right") col++;
  else row++;

  const hero = document.getElementById("hero");
  hero.style.animation = "moveChar 0.6s";
  setTimeout(() => hero.style.animation = "", 600);

  updateUI();
  triggerRandomEvent();
}

    function submitScore() {
      const name = document.getElementById("playerName").value.trim();
      if (!name) return alert("è«‹è¼¸å…¥åå­—");
      const entry = { name, score, time: Date.now() };
      const local = JSON.parse(localStorage.getItem("voting_scores") || "[]");
      local.push(entry);
      localStorage.setItem("voting_scores", JSON.stringify(local));
      loadScores();
      document.getElementById("submitSection").style.display = "none";
    }

    function loadScores() {
      const list = document.getElementById("scoreList");
      list.innerHTML = "";
      const local = JSON.parse(localStorage.getItem("voting_scores") || "[]");
      local.sort((a,b) => b.score - a.score).slice(0,5).forEach(entry => {
        const li = document.createElement("li");
        li.textContent = `${entry.name}: ${entry.score} åˆ†`;
        list.appendChild(li);
      });
    }

    updateUI();
    loadScores();
    let gameEnded = false;

function restartGame() {
  row = 0;
  col = 1;
  score = 0;
  steps = 0;
  gameEnded = false;
  document.getElementById("quizBox").style.display = "none";
  document.getElementById("winMessage").textContent = "";
  document.getElementById("submitSection").style.display = "none";
  document.getElementById("restartBtn").style.display = "none";
  document.querySelectorAll('.btn').forEach(btn => btn.disabled = false);
document.getElementById("hero").classList.remove("special");
  updateUI();
  document.getElementById("eventText").textContent = "å†’éšªé–‹å§‹ï¼é¸æ“‡ä¸€å€‹æ–¹å‘å‰é€²å§ï¼";
}
  </script>
</body>
</html>
